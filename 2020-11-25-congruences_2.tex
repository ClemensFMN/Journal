\DiaryEntry{Linear Congruences and the Chinese Remainder Theorem }{2020-11-25}{Number Theory}

\subsection{Linear Congruences}

We consider the \emph{linear congruence},

\bee
ax \equiv b \mod n
\eee

and seek solution(s) $x_0$ so that $ax_0 \equiv b \mod n$. 

A simple example is given by

\bee
4x \equiv 8 \mod 6
\eee

By trying out values (I also used \href{https://www.a-calculator.com/congruence/}{this}), we obtain two solutions $x_0 = 2$ and $x_0 = 5$. Since congruences do not change when we add $n$ to one side, we can obtain infinitely many solutions from these two by

\bee
    x_0 = 2 + 6k, x_0 = 5 + 6k, \quad k \in \Zc_0
\eee

which we can combine into the following

\bee
x = 2 + 3k, \quad k \in \Zc_0
\eee

The solutions $2$ and $5$ are called \emph{mutually incongruent} because they yield a different remainder when divided by $n = 3$.

\begin{theorem}
    The linear congruence $ax \equiv b \mod n$ has a solution iff $d = \gcd(a, n) \mid b$. If $d \mid b$, then it has $d$ mutually incongruent solutions module $n$. If $x_0$ is such a solution, then the $d$ incongruent solutions are given by

    \bee
        x_0, x_0 + \frac{n}{d}, x_0 + 2\frac{n}{d}, \ldots, x_0 + (d-1)\frac{n}{d}
    \eee
\end{theorem}

We do not give the proof here, but note that the linear congruence is equivalent to the linear Diophantine equation $ax - ny = b$: The congruence $ax \equiv b \mod n$ is equivalent to $n \mid (ax_0 - b)$ which we can also write as $a x_0 - b = n y_0$ for some integer $y_0$. Thus solving a linear congruence is the same as solving the linear Diophantine equation $a x - b = n y$. We have treated the linear Diophantine equation in \ref{2020-08-11:entry}.


\paragraph{Example.} Let's continue with our running example of 

\bee
4x \equiv 8 \mod 6
\eee

This is equivalent to the Diophantine equation

\bee
4x - 8 = 6y \rightarrow 4x - 6y = 8
\eee

Using the extend Euclidean algorithm we obtain

\bee
gcd(4,6) = 2 = (-1) \cdot 4 + 1 \cdot 6
\eee

We can use this in $8 = 4x - 6y$ by writing

\bee
4 \cdot \gcd(4,6) = 4 \cdot 2 = 4 \cdot (-1) \cdot 4 + 4 \cdot 1 \cdot 6 = (-4) \cdot 4 + 4 \cdot 6
\eee

from which we read off $x_0 = -4$. Therefore, the set of solutions given by

\bee
x = x_0 + k \frac{6}{2} = -4 + 3k = -1, 2, 5, 8, \ldots
\eee

\paragraph{Multiplicative Inverse module $n$.} As a corollary, we have.

\begin{theorem}
    If $\gcd(a,n) = 1$, then $a x \equiv b \mod n$ has a unique solution modulo $n$. In particular, $a x \equiv 1 \mod n$ has a unique solution called the \emph{(multiplicative) inverse} of $a$ modulo $n$. Note that the condition $\gcd(a,n) = 1$ is trivially fulfilled when $n$ is prime.
\end{theorem}

We can calculate the multiplicative inverse module $n$ via a slight variation of the extended Euclidean algorithm. From above we know that $ax \equiv 1 \mod n$ is equivalent to the linear Diophantine equation $ax - ny = 1$. The extended Euclidean algorithm (entries \ref{2020-08-11:entry} and \ref{2020-08-20:entry}) solves $ar + bs = \gcd(a,b)$. Choosing $a = a, b = -n$, $\gcd(a,b) = \gcd(a, n) = 1$ is fulfilled and the algorithm yields a solution for $r,s$. We are only interested in $r$ and there is a slightly more efficient algorithm available (more efficient as it only calculates $r$) shown \href{https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm}{here}. In Julia, the implementation looks as follows (note the close resemblence to the Julia code in entry \ref{2020-08-20:entry})

\begin{verbatim}
    function inverse_mod(a, n)
        t = 0
        newt = 1
        r = n
        newr = a

        while(newr != 0)
            quotient = div(r, newr)
            (t, newt) = (newt, t - quotient * newt) 
            (r, newr) = (newr, r - quotient * newr)
        end

        if(r > 1)
            error("a is not invertible")
        end

        if(t < 0)
            t = t + n
            return t
        end
    end
\end{verbatim}

As an example, consider $4x \equiv 1 \mod 17$. Calling above function yields $x = 13$ and indeed we have $4 \cdot 13 \equiv 1 \mod 17$.

We can use the multiplicative inverse to solve (some) linear congruences. As example, consider

\bee
4x \equiv 2 \mod 7
\eee

The inverse of $7$ module-$7$ is $2$ and we multiply both sides by it and obtain

\bee
2 \cdot 4x \equiv 2 \cdot 2 \mod 7 \rightarrow x \equiv 4 \mod 7
\eee


\subsection{Chinese Remainder Theorem}

We extend the linear congruences to a system of linear congruences. Existence of a solution is given by the Chinese remainder theorem.

\begin{theorem}
    Let $n_1, n_2, \ldots, n_r$ be positive integers such that $\gcd(n_i, n_j) = 1$ for all $i \neq j$. Then the system of linear congruence

    \begin{align*}
        x &\equiv a_1 \mod n_1 \\
        x &\equiv a_2 \mod n_2 \\
        & \cdots \\
        x &\equiv a_r \mod n_r
    \end{align*}

    has a solution, which is unique modulo $n_1 n_2 \cdots n_r$.
\end{theorem}

For a proof, we consider $n = n_1 n_2 \cdots n_r$. For each $k=1, 2, \ldots r$, let $N_k = \frac{n}{n_k} = n_1 \cdots n_{k-1} n_{k+1} \cdots n_r$. The $n_i$ are all relatively prime in pairs, therefore $\gcd(N_k, n_k) = 1$. Therefore (by the theorem for linear congruences), there is a solution to $N_k x \equiv 1 \mod n_k$ which we denote by $x_k$. We want to show that

\bee
\bar{x} = a_1 N_1 x_1 + a_2 N_2 x_2 + \cdots + a_r N_r x_r
\eee

is a solution to the system of linear congruences. We first observe that $N_i \equiv 0 \mod n_k$ for $i \neq k$, because $n_k \mid N_i$ in this case. From this follows

\bee
\bar{x} = a_1 N_1 x_1 + a_2 N_2 x_2 + \cdots + a_r N_r x_r \equiv a_k N_k x_k \mod n_k
\eee

But $x_k$ was chosen to satisfy $N_k x \equiv 1 \mod n_k$ and therefore the RHS becomes

\bee
\bar{x} \equiv a_k \cdot 1 \equiv a_k \mod n_k
\eee

This shows that $\bar{x}$ is a solution to the system of linear congruences. To show that this is a unique solution, suppose that $x'$ is another solution. Then

\bee
\bar{x} \equiv a_k \equiv x' \mod n_k
\eee

for all $k = 1, 2, \ldots r$ and so $n_k \mid (\bar{x} - x')$ for each value of $k$. Because $\gcd(n_i, n_j) = 1$, it follows that $n_1 n_2 \cdots n_r \mid (\bar{x} - x')$ and therefore $\bar{x} \equiv x' \mod n$. \qed

\paragraph{Example.} Consider the following system of linear congruences.

\begin{align*}
    x \equiv 2 \mod 3 \\
    x \equiv 3 \mod 5 \\
    x \equiv 2 \mod 7
\end{align*}

We have $n = 3 \cdot 5 \cdot 7 = 105$ and $N_1 = \frac{105}{3} = 35, N_2 = 21, N_3 = 15$. We therefore need to solve the linear congruences

\bee
35x \equiv 1 \mod 3, \quad 21x \equiv 1 \mod 5, \quad 15x \equiv 1 \mod 7
\eee

Using the modified extended Euclidean algorithm, we obtain the three solutions $x_1 = 2, x_2 = x_3 = 1$. The general solution is therefore given by 

\bee
\bar{x} = 2 \cdot 35 \cdot 2 + 3 \cdot 21 \cdot 1 + 2 \cdot 15 \cdot 1 = 233
\eee

We can reduce this by taking it modulo-$n$ and obtain $x = 233 \equiv 23 \mod 105$.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "journal"
%%% End:
