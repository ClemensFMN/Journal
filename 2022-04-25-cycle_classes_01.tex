\DiaryEntry{Permutations - Counting Cycle Classes}{2022-04-25}{Combinatorics}

This is based on \cite{Dominus2007}. We consider permutations and their cycles. A permutation is a mapping from a set $\Sc$ to itself. A cycle of a permutation is a subset of the set for which the elements fall into a single orbit. We can assign permutations into cycle classes by saying that two permutations are in the same cycle class if the lengths of the cycles are all the same.

Consider $n = 3$ elements. We have $3! = 6$ different permutations and we classify them according to their cycles as follows,

\vspace{2mm}

\begin{tabular}{|c|c|c|}
  Cycle Structure & Permutations & \# Permutations \\ \hline
  three $1$-cycles $[1,1,1] $ & $(1)(2)(3)$ & $1$ \\
  one $1$-cycle and one $2$-cycle $[1,2]$ & $(1)(2,3) \;\; (2)(1,3) \;\; (3)(1,2)$ & $3$ \\
  one $3$-cycle $[3]$ & $(1,2,3) \;\; (2,1,3)$ & $2$
\end{tabular}

\vspace{2mm}

Note that the total counts of all items in the cycle classes for permutations of $n$ items adds up to $n!$.

We want to count the number of permutations in a cycle class: A cycle class $\Cc=(p_1, p_2, \ldots)$ contains $p_1$ permutations of length $1$, $p_2$ permutations of length $2$ and so on. All elements from $1$ to $n$ must be used (each in a separate cycle), so we have

\bee
\sum_i i p_i = n
\eee

The number of permutations in a cycle class $\Cc$ is given by (for a sketch proof, see the end of the entry)

\be\label{2022-04-25:eq1}
|\Cc| = \frac{n!}{\prod_i i^{p_i} p_i!}
\ee

In our example, the number permutations having three $1$-cycles ($p_1 = 3, p_2=p_3=0$) is $|\Cc| = 3! / ((1^3 3!) \cdot 1 \cdot 1) = 1$, the number of permutations having one $1$-cycle and one $2$-cycle ($p_1 = p_2 = 1, p_3=0$) is $|\Cc| = 3! / ((1^1 1!) \cdot (2^1 1!) \cdot 1) = 3$, and finally the number of permutations having one $3$-cycle ($p_1=p_2=0, p_3 = 1$) is $|\Cc| = 3! / (1 \cdot 1 \cdot (3^1 1!)) = 2$. \qed

We next consider $n=5$ items. As an example, we consider $[3,1,1]$ which is the permutation class having one $3$-cycle and two $1$-cycles. This implies $p_1=2, p_3=1$ and therefore $|\Cc| = 5! / ((1^2 2!) \cdot (3^1 1!)) = 10$. 

The following table shows the cycle structure and cardinality.

\vspace{2mm}

\begin{tabular}{cc}
    Cycle Structure & Number \\ \hline
    $[5]$ &  24 \\
    $[4, 1]$ & 30 \\
    $[3, 2]$ & 20 \\
    $[3, 1, 1]$ & 20 \\
    $[2, 2, 1]$ & 15 \\
    $[2, 1, 1, 1]$ & 10 \\
    $[1, 1, 1, 1, 1]$ & 1
\end{tabular}

\vspace{2mm}

The first row contains the permutation class having one $n$-cycle. We have $p_n=1$ and therefore $|\Cc| = n!/(n^1 1!) = (n-1)!$.The last line denotes the permutation class having only $1$-cycles and there is only one such class (We have $p_1=n$ and therefore $|\Cc| = n!/(1^n n!) = 1$). We also see that most permutations have one fixed point and one permutation of cycle length $n-1=4$. Therefore $p_1=1, p_{4}=1$ and $|\Cc| = 5!/(1^1 1! \cdot 4^1 1! ) = 30$.

The case of $n=7$ has the same behaviour with a maximum of $840$ permutations having one fixed point and one permutation of cycle length $6$ (We have $p_1=1, p_6=1$ and therefore $|\Cc| = 7!/(1^1 1! \cdot 6^1 1!) = 840$).

Note: This may not be so easy as we need to find the location of the $|\Cc|$ maximum in the expression above. In the entry \ref{2016-01-04:entry} we calculate the expected number of fixed points in case of large $n$ which is one. However, this does not imply that the maximum of $|\Cc|$ is attained with one fixed point.


\paragraph{Relation with permutations having $k$ fixed points.} The permutation classes are related to the number of permutations having $k$ fixed points (see \cite{Baez2019} and entry \ref{2016-01-04:entry}). We choose $k$ points and create a derangement of the remaining $n-k$ points (so that we do not have any additional fixed points); therefore, we have

\bee
{n \choose k} !(n-k)
\eee

permutations of length $n$ with $k$ fixed points.

As an example we consider $n=4$ and $k=2$ fixed points. We have ${4 \choose 2} !(2) = 6$ and these permutations are $(1)(2)(3,4), (1)(3)(2,4), (1)(4)(2,3), (2)(3)(1,4), (2)(4)(1,3), (3)(4)(1,2)$. We see that these permutations are the permutation class $\Cc = [1,1,2]$. With $p_1=2, p_2=1$ we have
\bee
|\Cc| = \frac{4!}{ 1^2 2! \cdot 2^1 1! } = 6
\eee

which matches the calculations in the preceding paragraph. \qed

As a more complex example, consider the case of $n=6$ and $k=2$ fixed points. We have ${6 \choose 2} !4 = 135$ permutations. These permutations will belong to \emph{one} of the following two permutation classes $\Cc_1 = [1,1,4]$ (e.g. $(1)(2)(3,4,5,6)$) and $\Cc_2 = [1,1,2,2]$ (e.g. $(1)(2)(3,4)(5,6)$).
The size of these two permutation classes are (with $p_1=2, p_4=1$ for $\Cc_1$ and $p_1=2, p_2=2$ for $\Cc_2$) given as

\bee
|\Cc_1| = \frac{6!}{1^2 2! \cdot 4^1 1! } = 90 \quad |\Cc_2| = \frac{6!}{1^2 2! \cdot 2^2 2!} = 45
\eee

In order to get the total number of permutations (having two fixed points), we need to add these two cardinalities, $|\Cc_1| + |\Cc_2| = 135$ which matches the result from above. \qed

\paragraph{Prof of \eqref{2022-04-25:eq1}, Cardinality of Cycle Class.} Let's start with the case where all cycles occur only once (if at all). As example, consider $n=8$ and ask for the size of the cycle class $[5, 2, 1]$ ($p_1=1, p_2=1, p_5=1$). All permutations of this class must have the following form

\bee
(\cdot, \cdot, \cdot, \cdot, \cdot)(\cdot, \cdot)(\cdot)
\eee

We can place our $n=8$ elements in $8!$ different ways into these 8 slots. Each cycle can be restarted anywhere; e.g. $(1,2,3,4,5)$ can also be represented as $(2,3,4,5,1), (3,4,5,1,2), \cdots$. In total, each cycle of length $i$ can be represented in $i$ equivalent ways; therefore the size of the cycle class is $8! / (5 \cdot 2 \cdot 1)$.

This special case of having only one cycle of a specific length is covered by

\bee
|\Cc| = \frac{n!}{\prod_i i^{p_i} }
\eee

and this uses the fact that all $i^0 = 1$; so ``non-existing'' cycles do not affect the result.

What happens if we consider cycle classes with $p_i > 1$; e.g. [3,3,3,3,3]? We have $p_3=5$ and all permutations of this class must have the following form

\bee
(\cdot, \cdot, \cdot)(\cdot, \cdot, \cdot)(\cdot, \cdot, \cdot)(\cdot, \cdot, \cdot)(\cdot, \cdot, \cdot)
\eee

With the reasoning from before, each cycle can be represented in $3$ equivalent ways, so we need to divide $15!$ by $3^5$. In addition, we can also juggle the cycles around; e.g. $(1,2,3)(4,5,6)(7,8,9)\\(10,11,12)(13,14,15)$ is equivalent to $(4,5,6)(1,2,3)(7,8,9)(10,11,12)(13,14,15)$. In total, there are $5!$ ways to do that. So, all in all, the size of the cycle class is $15!/(3^5 \cdot 5!)$ and this case is covered by

\bee
|\Cc| = \frac{n!}{\prod_i i^{p_i} \cdot p_i!}
\eee

Similar to above, this uses the fact that $i^0 0! = 1$; so ``non-existing'' cycles do not affect the result. Combining several such cases together, we finally arrive at \eqref{2022-04-25:eq1}.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "journal"
%%% End:
