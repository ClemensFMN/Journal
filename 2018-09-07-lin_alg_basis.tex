\DiaryEntry{Why $\{1, x, x^2\}$ is a bad Basis}{2018-09-07}{Maths}


Based on the \href{https://www.youtube.com/watch?v=pYoGYQOXqTk&index=14&list=PL.}{YT Lecture}.

\subsection{Introduction}

First question is how to express a vector $\xbf=(x_1,x_2)^T$ in a non-orthogonal basis with vectors $\ubf_1, \ubf_2$ and coefficients $a_1, a_2$

\bee
\xbf = a_1 \ubf_1 + a_2 \ubf_2
\eee

We calculate the inner product with $\ubf_1$ and $\ubf_2$, repsectively and assume the basis vectors have length $1$ (i.e. $\ubf_i \cdot \ubf_i = 1$),

\begin{align*}
  \xbf \cdot \ubf_1 &= a_1 + a_2 \ubf_2 \cdot \ubf_2 \\
  \xbf \cdot \ubf_2 &= a_1 \ubf_1 \cdot \ubf_2 + a_2
\end{align*}

These are two equations with 2 unknowns and can be solved.

In the special case of an orthonormal basis, $\ubf_i \ubf_j = \delta_{i,j}$, we obtain

\begin{align*}
  \xbf \cdot \ubf_1 &= a_1 \\
  \xbf \cdot \ubf_2 &= a_2
\end{align*}

In words, the two basis coefficients are given by the inner product of the vector with the basis vectors.

As a concrete example for the general 2-dimensional case, we consider

\bee
\ubf_1 = (1,0)^T, \quad \ubf_2=(\cos \phi, \sin \phi)^T
\eee

and obtain the following two equations

\begin{align}\label{2018-09-07:eq1}
  x_1 &= a_1 + a_2 \cos \phi \\
  x_1 \cos \phi + x_2 \sin \phi &= a_1 \cos \phi + a_2 \nonumber
\end{align}

From the first equation we obtain $a_1 = x_1 - a_2 \cos \phi$ which we insert into the second equation,

\bee
x_1 \cos \phi + x_2 \sin \phi = (x_1 - a_2 \cos \phi) \cos \phi + a_2 \rightarrow \cdots \rightarrow a_2 = \frac{x_2}{\sin \phi}
\eee

Inserting back, we obtain

\bee
a_1 = x_1 - \frac{x_2}{\tan \phi}
\eee

For $\phi = \pi/2$, this becomes $a_1 = x_1$ and $a_2 = x_2$. In case of small angles $\phi$, both $\sin\phi$ and $\tan \phi$ become very small. Since both are in the denomiator, a small change in $x_2$ causes large changes if $a_1, a_2$; i.e. the basis expansion becomes very sensitive to movements of $\xbf$, which is not desirable (imagine that $\xbf$ is a noisy measurement). This can also be seen when we express \eqref{2018-09-07:eq1} in matrix form,

\bee
\Mbf = \begin{pmatrix} 1 & \cos \phi \\
  \cos \phi & 1
\end{pmatrix}
\eee

and calculate the matrix condition number. E.g., for $\phi=0.1$, we obtain a condition number of $\approx 400$ which is a rather high value and shows the high sensitivity.


\subsection{Polynomials (Legendre Polynomials}

From the above discussion we see that an orthonormal basis (i) allows easy basis expansion and (ii) is not sensitive for errors. If we think of expressing a function by means of polynomials, we have lots of options for the ``basis functions''. One obvious choice would be $\Bc = \{1, x, x^2, x^3, \ldots\}$; however these functions are not orthogonal (on the interval $[-1;1]$

\bee
<x^m, x^n> = \int_{-1}^1 x^{m+n} dx = \left. \frac{x^{m+n+1}}{m+n+1}\right|_{-1}^1 = \begin{cases}
  \frac{2}{m+n+1}, & \quad m+n \, \text{even,} \\
  0 & \quad m+n \text{odd}
\end{cases}
\eee

The Legendre polynomials are orthonormal on $[-1,1]$


\paragraph{Using Maxima.} See the following example session

\begin{verbatim}
load(orthopoly);
rat(legendre_p(3,x));
(5*x^3-3*x)/2
integrate(legendre_p(1,x)*legendre_p(2,x),x,-1,1);
0
\end{verbatim}

For the fun of it, we express $x^2$ in terms of Legendre polynomials $P_0(x) = 1, P_1(x) = x, P_2(x) = \frac{1}{2}(3x^2-1)$. We first note that the Legendre polynomials are not normed to one; instead we have

\bee
<P_M,P_n> = \frac{2}{2m+1} \delta_{m,n}
\eee

We therefore the normed Legendre polynomials as

\bee
\tilde{P}_m(x) = \sqrt{\frac{2m+1}{2}} P_m(x)
\eee

For our case, this means that $\tilde{P}_0(x) = \sqrt{\frac{1}{2}}, \tilde{P}_1(x) = \sqrt{\frac{3}{2}}x, \tilde{P}_2(x) = \sqrt{\frac{5}{2}}\frac{1}{2}(3x^2-1)$. The inner products $a_i = <x^2, \tilde{P}_i>$ are calculated using Maxima and we also use Maxima to verify that $\sum_i a_i \tilde{P}_i = x^2$. See the following Maxima session.

\begin{verbatim}
(%i36)	p0:sqrt(1/2);
(b0)	1/sqrt(2)
(%i38)	p1:sqrt(3/2)*x;
(b1)	(sqrt(3)*x)/sqrt(2)
(%i43)	p2:sqrt(5/2)*1/2*(3*x^2-1);
(b2)	(sqrt(5)*(3*x^2-1))/2^(3/2)
(%i37)	a0:integrate(x^2*p0,x,-1,1);
(a0)	sqrt(2)/3
(%i45)	a1:integrate(x^2*sqrt(3/2)*p1,x,-1,1);
(a1)	0
(%i46)	a2:integrate(x^2*p2,x,-1,1);
(a2)	2^(3/2)/(3*sqrt(5))
(%i47)	a0*p0+a1*p1+a2*p2;
(%o47)	(3*x^2-1)/3+1/3
(%i48)	ratsimp((3*x^2-1)/3+1/3);
(%o48)	x^2
\end{verbatim}

\qed

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "journal"
%%% End:
