\DiaryEntry{The Mayor's Dilemma}{2017-11-16}{Stochastic}

Based on Steutel, "The Mayor's Dilemma" (Math. Scientist, 34) also  \href{files/34_2_1.pdf}{here}.

$K(n)$ is the random number of hundred euro bills; $\mE\{K(n)\}$ is its expectation. We will derive a relation between $\mE\{K(n+1)\}$ and $\mE\{K(n)\}$ as follows: When an $n+1$-th inhabitant is added, it is the largest with probability $1/(n+1)$ and one further bill is needed. It is not the largest with probability $1 - 1/(n+1) = n/(n+1)$ and in this case no further bill is needed. Therefore, we have 

\bee
\mE\{K(n+1)\} = \frac{n}{n+1}\mE\{K(n)\} + \frac{1}{n+1}\left[ \mE\{K(n)\}+1 \right] = \mE\{K(n)\} + \frac{1}{n+1}
\eee

With $\mE\{K(1)\} = 1$ we have

\bee
\mE\{K(n)\} = \sum_{k=1}^n \frac{1}{k}
\eee

This is the well-known harmonic series which behaves for large $n$ like

\bee
\mE\{K(n)\} \approx \log n + \gamma \approx \log n + 0.5772
\eee

Calculating the variance $\mE\{K^2(n)\}$ can be done as follows: The variance of $K(n+1)$ is the same as the variance of $K(n)$ with probability $n/(n+1)$ and the variance increases by one with the remaining probability $1 - n/(n+1) = 1/(n+1)$. This yields the following expression

\be
\label{2017-11-16:eq1}
\mE\{K^2(n+1)\} = \frac{n}{n+1} \mE\{K^2(n)\} + \frac{1}{n+1} \mE\{(K(n) + 1)^2\}
\ee

However, I'm not sure about the last summand; the notation in the paper is a nightmare and really unclear.

Let's assume that this is correct and continue

\bee
\mE\{K^2(n+1)\} = \frac{n}{n+1} \mE\{K^2(n)\} + \frac{1}{n+1} \mE\{K^2(n) + 2 K(n) + 1 \} = \mE\{K^2(n)\} + \frac{2}{n+1} \mE\{K(n)\} + \frac{1}{n+1}
\eee

Using the result for $\mE\{K(n)\}$ from above, we further obtain

\bee
\mE\{K^2(n+1)\} = \mE\{K^2(n)\} + \frac{2}{n+1} \sum_{k=1}^n \frac{1}{k} + \frac{1}{n+1}
\eee

In order to get a closed-form expression for $\mE\{K^2(n+1)\}$, let us consider $n=1$. We have $\mE\{K(1)\} = 1$ and since this term's variance is zero, we have $\mE\{K^2(1)\} = 1$. Inserting this into the previous expression yields

\bee
\mE\{K^2(2)\} = \mE\{K^2(1)\} + \frac{2}{1+1} \sum_{k=1}^1 \frac{1}{k} + \frac{1}{1+1} = 1 + 1 \times 1 + \frac{1}{2} = \frac{5}{2}
\eee

Let's try something (hopefully) easier: Write the variance $\sigma^2_{n+1}$ of $K(n+1)$ as follows:

\bee
\sigma^2_{n+1} = \mE\{K^2(n+1)\} - \mE\{K(n+1)\}^2 = \mE\{K^2(n)\} + \frac{2}{n+1} \sum_{k=1}^n \frac{1}{k} + \frac{1}{n+1} - \left( \mE\{K(n)\} + \frac{1}{n+1} \right)^2
\eee

which can be simplified to

\bee
\sigma^2_{n+1} = \sigma_n^2 + \frac{2}{n+1} \sum_{k=1}^n \frac{1}{k} + \frac{1}{n+1} - 2 \frac{1}{n+1} \mE\{K(n)\} - \frac{1}{(n+1)^2}
\eee

Based on the definition of $\mE$, the second and fourth term cancel and we arrive at

\bee
\sigma^2_{n+1} = \sigma_n^2 + \frac{1}{n+1} - \frac{1}{(n+1)^2} = \sigma_n^2 + \frac{n}{(n+1)^2}
\eee

This looks nice, but is not the expression from the paper (at least, I don't think so). Either there is something wrong in the derivation or the whole ansatz \eqref{2017-11-16:eq1} is wrong.